---
title: "KNZ-incidence: Cleaning Biotic Datasets"
author: "Maya Parker-Smith"
date: "2023-03-01"
output: html_document
 smart: no
    theme: flatly
    float: yes
    css: "style.css"    
editor_options: 
  chunk_output_type: console
mainfont: Arial
mathfont: Arial
fontsize: 12pt
---


# {.tabset .tabset-pills .tabset-fade}

#KNZ-Incidence EAGER Project

## Setup and Overview

### **Setting up data for analysis**
#### This RMarkdown will be used for the inital data cleaning of the four biotic datasets in the EAGER Konza Temporal Incidence project. 

####The four datasets include bird sampling (knb-lter-knz.26.12 -> CB011.csv), grasshopper sweeping (knb-lter-knz.29.20 -> CGR021.csv & CGR022), small-mammal trapping (knb-lter-knz.88.9 -> CSM011.csv & CSM012.csv), and plant data- which includes biomass and species composition (knb-lter-knz.55.14 -> PAB011, and knb-lter-knz.69.21 -> PVC021.csv). All data were taken from the EDI Data Portal Repository. All are LTER datasets from Konza Prairie. Each dataset will have its own section for cleaning

###Libraries and Set-up 
```{r setup, include=FALSE}

## Clear environment 
rm(list=ls())


##Libraries
library(tidyverse)
library(cowplot)
library(bbmle)
library(multcomp)
library(mosaic)
library(readr)

```

## Bird Sampling
This section is dedicated to cleaning the bird-sampling dataset. Data was collected from 1981 to 2009. Watersheds that are supposedly included: N4B, N4D, 4A, N1B, 1D, R20A, R1B, 20C, 20B, N20B.

Author: Alice Boyle

ZIP file: knb-lter-knz.26.12

Data code: CBP01

File(s): CB011.csv

Summary of All Changes Up to 1993: 
1981: Transects were as presently located except no transect in N20B and there were transects in  N20C (now N01A), N20D (now part of N01B), N01C (now N02B), N01D (now part of N01B), and N04C (now N04B). 
1982: Transects in N20C (N01A) and N01C (N02B) were dropped, N20D was maintained in what is now N01B. N01D became the second transect in what is now N01B, and N04C transect was maintained in what is now N04B. N20B was added. 
1990: 004d became SA and transect was dropped.

```{r}
#Read in and view bird data
birds <- read_csv("Datasets_EAGER/Birds/knb-lter-knz.26.12/CBP011.csv")
View(birds)

#Changing classifications and names of columns
birds <- birds %>% mutate(RECYEAR = factor(RECYEAR),
                          RECMONTH = factor(RECMONTH),
                          RECDAY = factor(RECDAY),
                          SEASON = factor(SEASON),
                          TRANSNUM = factor(TRANSNUM),
                          WATERSHED = factor(WATERSHED),
                          OBSNUM = factor(OBSNUM),
                          SPECNAME = factor(SPECNAME),
                          AOUCODE = factor(AOUCODE),
                          COMMONNAME = factor(COMMONNAME),
                          DISTANCE = as.numeric(DISTANCE),
                          COUNT = as.numeric(COUNT), 
                          SEX = factor(SEX),
                          STATUS = factor(STATUS),
                          COMMENTS = as.character(COMMENTS))
glimpse(birds)


#Shortening the dataset to only have the columns we are interested in
birds_short <- birds %>% dplyr::select(RECYEAR, 
                                       RECMONTH, 
                                       RECDAY, 
                                       SEASON, 
                                       TRANSNUM,
                                       DISTANCE,
                                       WATERSHED, 
                                       OBSNUM, 
                                       SPECNAME,
                                       COMMONNAME,
                                       AOUCODE, 
                                       COUNT)


#Checking the species names to make sure there are any weird misspellings
unique(birds_short$SPECNAME)
unique(birds_short$COMMONNAME)
##There are 204 unique species names, but 138 unique common names. I'll probably have to go through the species names to their full species names because I don't know the shortened ones.


#Now checking the watersheds to see exactly what is here compared to what is said in the metadata
unique(birds_short$WATERSHED)

```

## Including Plots

```{r pressure, echo=FALSE}

#Looking at the distribution of bird observations by year
birds_short %>% ggplot(aes(x = RECYEAR, y = COUNT)) + geom_col() +  theme(text = element_text(size=10),
        axis.text.x = element_text(angle=45, hjust=1))


#Looking at the distribution of bird observations by watershed
birds_short %>% ggplot(aes(x = WATERSHED, y = COUNT)) + geom_col() +  theme(text = element_text(size=10),
        axis.text.x = element_text(angle=45, hjust=1))

```

So now I'm not quite sure what to do....
I think we should maybe drop 004D since it was added later...

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
